<!doctype html>
<html class="no-js">

<!-- Mirrored from learncodethehardway.org/more-python-book/ex22.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 08 Jul 2017 15:17:43 GMT -->
<head>



<meta charset="utf-8">
<title>Learn MORE Python the Hard Way</title>

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="description" content="">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="../../www.google-analytics.com/index.html" rel="dns-prefetch">
<link href="../../ajax.googleapis.com/index.html" rel="dns-prefetch">

<link href='../../fonts.googleapis.com/css33ad.css?family=Source+Code+Pro|Source+Sans+Pro:200,400,700,200italic,400italic,700italic' rel='stylesheet' type='text/css'>
<link href="../css/style.min.css" rel="stylesheet">
<!-- http://www.socicon.com -->
<link href="../css/icons.css" rel="stylesheet">

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.12: http://docutils.sourceforge.net/" />
<title>Exercise 22: Suffix Arrays</title>

</head>

<body class="baseline-grid-off book-site" id="top">




<header class="header" role="banner">
    <nav class="navbar navbar-full nav-brand-family">
        <div class="row middle-xs">
            <ul class="brand-links show-md col-xs-3 col-sm-10 bare">
                <li><a href="http://learncodethehardway.org/" class="waves-effect">Learn:</a></li>

                <li><a href="http://learncodethehardway.org/python/" class="waves-effect">Python</a></li>

                <li><a href="http://learncodethehardway.org/ruby/" class="waves-effect">Ruby</a></li>

                <li><a href="http://learncodethehardway.org/more-python/" class="waves-effect active">More Python</a></li>

                <li><a href="http://learncodethehardway.org/c/" class="waves-effect">C</a></li>

                <li><a href="http://learncodethehardway.org/sql/" class="waves-effect">SQL</a></li>

                <li><a href="http://learncodethehardway.org/javascript/" class="waves-effect">Javascript</a></li>

                <li><a href="http://learncodethehardway.org/unix/" class="waves-effect">Unix</a></li>

                <li><a href="http://learncodethehardway.org/regex/" class="waves-effect">RegEx</a></li>

                <li><a href="http://www.learndesignthehardway.com/" class="waves-effect">Design</a></li>

            </ul>
            <ul class="brand-links hide-md col-xs-3 col-sm-10 bare">
                <li><a href="http://learncodethehardway.org/" class="waves-effect">LCTHW</a></li>
            </ul>

            <ul class="site-meta col-xs-9 col-sm-2 end-xs bare">
                <li><a href="https://shop.learncodethehardway.org/access/reactivate/" class="waves-effect"><i class="icon icon-user"></i> Account</a></li>
            </ul>

        </div>
    </nav>

    <nav class="navbar navbar-full nav-main" role="navigation">
        <div class="row between-xs center-xs middle-xs bare">
            <div class="col-xs-4 start-xs bare">
                <a href="#" class="no-underline nav-trigger waves-effect" id="toc"><div class="transformer hamburcloser">
                        <div class="bar bar-t"></div>
                        <div class="bar bar-m-a"></div>
                        <div class="bar bar-m-b"></div>
                        <div class="bar bar-b"></div>
                </div><span class="nav-trigger_text show-sm-inline">Contents</span></a>
            </div>
            <div class="col-xs-4"><strong>&nbsp;</strong></div>
            <div class="col-xs-4 end-xs bare">
                <a href="https://helpthw.zendesk.com/hc/en-us" class="no-underline nav-trigger waves-effect" id="help"><div class="transformer questioncloser">
                        <div class="icon-question-mark"></div>
                </div><span class="nav-trigger_text show-sm-inline">Help</span></a>
            </div>
        </div>
    </nav>

</header>




<div class="wrapper">
    <div class="masthead more-python-background" style="background-image: url('../images/pattern-more-python.svg')">
        <img src="../images/logo-more-python.svg" alt="Learn MORE Python The Hard Way" class="logo">
    </div>

    <aside class="sidebar sidebar-left" role="complementary">
        <nav class="side-nav-container">
            <ol class="table-of-contents">
                <h3>Table of Contents</h3>
                <li><a class="reference external" href="part0.html">I: Initial Knowledge</a></li>
                <li><a class="reference external" href="ex0.html">0 The Setup</a></li>
                <li><a class="reference external" href="ex1.html">1 On Process</a></li>
                <li><a class="reference external" href="ex2.html">2 On Creativity</a></li>
                <li><a class="reference external" href="ex3.html">3 On Quality</a></li>
                <li><a class="reference external" href="part1.html">II: Quick Hacks</a></li>
                <li><a class="reference external" href="ex4.html">4 Dealing With Command Line Arguments</a></li>
                <li><a class="reference external" href="ex5.html">5 cat</a></li>
                <li><a class="reference external" href="ex6.html">6 find</a></li>
                <li><a class="reference external" href="ex7.html">7 grep</a></li>
                <li><a class="reference external" href="ex8.html">8 cut</a></li>
                <li><a class="reference external" href="ex9.html">9 sed</a></li>
                <li><a class="reference external" href="ex10.html">10 sort</a></li>
                <li><a class="reference external" href="ex11.html">11 uniq</a></li>
                <li><a class="reference external" href="ex12.html">12 Review</a></li>
                <li><a class="reference external" href="part2.html">III: Data Structures</a></li>
                <li><a class="reference external" href="ex13.html">13 Single Linked Lists</a></li>
                <li><a class="reference external" href="ex14.html">14 Double Linked Lists</a></li>
                <li><a class="reference external" href="ex15.html">15 Stacks and Queues</a></li>
                <li><a class="reference external" href="ex16.html">16 Bubble, Quick, Merge Sort</a></li>
                <li><a class="reference external" href="ex17.html">17 Dictionary</a></li>
                <li><a class="reference external" href="ex18.html">18 Measuring Performance</a></li>
                <li><a class="reference external" href="ex19.html">19 Improving Performance</a></li>
                <li><a class="reference external" href="ex21.html">21 Binary Search Trees</a></li>
                <li><a class="reference external" href="ex22.html">22 Binary Search</a></li>
                <li><a class="reference external" href="en23.html">23 Ternary Search</a></li>
                <li><a class="reference external" href="ex24.html">24 Suffix Arrays</a></li>
                <li><a class="reference external" href="part3.html">IV: Intermediate Projects</a></li>
                <li><a class="reference external" href="ex25.html">25 xargs</a></li>
                <li><a class="reference external" href="ex26.html">26 hexdump</a></li>
                <li><a class="reference external" href="ex27.html">27 tr</a></li>
                <li><a class="reference external" href="ex28.html">28 sh</a></li>
                <li><a class="reference external" href="ex29.html">29 diff and patch</a></li>
                <li><a class="reference external" href="part4.html">V: Parsing Text</a></li>
                <li><a class="reference external" href="ex30.html">30 Finite State Machines</a></li>
                <li><a class="reference external" href="ex31.html">31 Regular Expressions</a></li>
                <li><a class="reference external" href="ex32.html">32 Scanners</a></li>
                <li><a class="reference external" href="ex33.html">33 Parsers</a></li>
                <li><a class="reference external" href="ex34.html">34 Analyzers</a></li>
                <li><a class="reference external" href="ex35.html">35 Interpreters</a></li>
                <li><a class="reference external" href="ex36.html">36 Simple Calculator </a></li>
                <li><a class="reference external" href="ex37.html">37 Little BASIC</a></li>
                <li><a class="reference external" href="part5.html">VI: SQL Databases</a></li>
                <li><a class="reference external" href="ex38.html">38 Introduction to SQL</a></li>
                <li><a class="reference external" href="ex39.html">39 Creating with SQL</a></li>
                <li><a class="reference external" href="ex40.html">40 Reading with SQL</a></li>
                <li><a class="reference external" href="ex41.html">41 Updating with SQL</a></li>
                <li><a class="reference external" href="ex42.html">42 Deleting with SQL</a></li>
                <li><a class="reference external" href="ex43.html">43 SQL Administration</a></li>
                <li><a class="reference external" href="ex44.html">44 Using Python Database API</a></li>
                <li><a class="reference external" href="ex45.html">45 Creating an ORM</a></li>
                <li><a class="reference external" href="part6.html">VII: Final Projects</a></li>
                <li><a class="reference external" href="ex46.html">46 blog</a></li>
                <li><a class="reference external" href="ex47.html">47 bc</a></li>
                <li><a class="reference external" href="ex48.html">48 ed</a></li>
                <li><a class="reference external" href="ex49.html">49 sed</a></li>
                <li><a class="reference external" href="ex50.html">50 vi</a></li>
                <li><a class="reference external" href="ex51.html">51 lessweb</a></li>
                <li><a class="reference external" href="ex52.html">52 moreweb</a></li>
            </ol>
            <ul class="site-links">
                <h3>Learn the Hard Way</h3>
                <li><a href="#" class="waves-effect"><i class="icon-information"></i> About LPTHW</a></li>
                <li><a href="#" class="waves-effect"><i class="icon-question-mark"></i> Help &amp; Support</a></li>
                <li><a href="#" class="waves-effect"><i class="socicon-twitter"></i> Follow us on Twitter</a></li>
            </ul>
        </nav>
        <div class="colophon text-center">
            <div class="intro">
                <p class="bare-bottom">
                The type for this book is set in 18px / 1.5
                <a href="https://www.google.com/fonts/specimen/Source+Serif+Pro">Adobe Serif</a>,
                <a href="https://www.google.com/fonts/specimen/Source+Sans+Pro">Sans</a>, and
                <a href="https://www.google.com/fonts/specimen/Source+Code+Pro">Code</a>.
                </p>
            </div>
            <div class="printers-mark">
                <div class="inscription">Docendo <i class="icon-repeat"></i> Discimus</div>
            </div>
        </div>
    </aside>

    <div class="overlay"></div>

    <main class="main more python" role="main">
    <div class="main-container row center-xs">
        <div class="col-xs-11 col-sm-10 col-md-9 col-lg-8">

            <div class="content">
                <div class="warning">
                    <p class="first admonition-title">Warning</p>
                    <p class="last">This book is new.  If you'd like to go through it, then join the <a class="reference external" href="https://gitter.im/lcthw/more-python-help">Gitter Chat</a> to get help while you attempt it.  I'm also looking for feedback on the difficulty of the projects.  If you don't like chat, then email <a class="reference external" href="mailto:help&#64;learncodethehardway.org">help&#64;learncodethehardway.org</a> to talk privately.</p>
                </div>
                <!--- RST STARTS -->
                <h1 class="title">Exercise 22: Suffix Arrays</h1>
                <p>I'd like to tell you a story about suffix arrays.  I was interviewing at a company in Seattle during a time I was curious about how to most efficiently create a diff on an executable binary.  My research brought me to the algorithms Suffix Array and Suffix Tree.  The Suffix Array is simply where you sort all the suffixes of a string into a sorted list.  The Suffix Tree is similar but done more like a <tt class="docutils literal">BSTree</tt> than a list.  These algorithms were fairly simple and had fast performance once you did the sorting operation.  The problem they solved was finding the longest common substring between two strings (or in this case, lists of bytes).</p>
<p>You can make a suffix array in Python really easily:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><a name="python--ex22_pycon.py-idio.html-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">magic</span> <span class="o">=</span> <span class="s2">&quot;abracadabra&quot;</span>
<a name="python--ex22_pycon.py-idio.html-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">magic_sa</span> <span class="o">=</span> <span class="p">[]</span>
<a name="python--ex22_pycon.py-idio.html-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">magic</span><span class="p">)):</span>
<a name="python--ex22_pycon.py-idio.html-4"></a><span class="o">...</span>     <span class="n">magic_sa</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">magic</span><span class="p">[</span><span class="n">i</span><span class="p">:])</span>
<a name="python--ex22_pycon.py-idio.html-5"></a><span class="o">...</span>
<a name="python--ex22_pycon.py-idio.html-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">magic_sa</span>
<a name="python--ex22_pycon.py-idio.html-7"></a><span class="p">[</span><span class="s1">&#39;abracadabra&#39;</span><span class="p">,</span> <span class="s1">&#39;bracadabra&#39;</span><span class="p">,</span> <span class="s1">&#39;racadabra&#39;</span><span class="p">,</span> <span class="s1">&#39;acadabra&#39;</span><span class="p">,</span>
<a name="python--ex22_pycon.py-idio.html-8"></a> <span class="s1">&#39;cadabra&#39;</span><span class="p">,</span> <span class="s1">&#39;adabra&#39;</span><span class="p">,</span> <span class="s1">&#39;dabra&#39;</span><span class="p">,</span> <span class="s1">&#39;abra&#39;</span><span class="p">,</span> <span class="s1">&#39;bra&#39;</span><span class="p">,</span> <span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">]</span>
<a name="python--ex22_pycon.py-idio.html-9"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">magic_sa</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">magic_sa</span><span class="p">)</span>
<a name="python--ex22_pycon.py-idio.html-10"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">magic_sa</span>
<a name="python--ex22_pycon.py-idio.html-11"></a><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;abra&#39;</span><span class="p">,</span> <span class="s1">&#39;abracadabra&#39;</span><span class="p">,</span> <span class="s1">&#39;acadabra&#39;</span><span class="p">,</span> <span class="s1">&#39;adabra&#39;</span><span class="p">,</span> <span class="s1">&#39;bra&#39;</span><span class="p">,</span>
<a name="python--ex22_pycon.py-idio.html-12"></a> <span class="s1">&#39;bracadabra&#39;</span><span class="p">,</span> <span class="s1">&#39;cadabra&#39;</span><span class="p">,</span> <span class="s1">&#39;dabra&#39;</span><span class="p">,</span> <span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;racadabra&#39;</span><span class="p">]</span>
<a name="python--ex22_pycon.py-idio.html-13"></a><span class="o">&gt;&gt;&gt;</span>
</pre></div>
</td></tr></table><p>As you can see, I simply took the suffixes of the string in order, and then sorted the list.  But, what does this do for me?  Once I have this list, then I can find any suffix I want by simply doing a <em>binary search on this list</em>.  This example is very crude, but in real code you can do this very quickly, and you can keep track of all the original indexes so you can then reference the suffixes' original locations.  It is very fast compared to other search algorithms and very useful in things like DNA analysis.</p>
<p>Back to the interview in Seattle.  I'm in this cold room being interviewed by C++ programmers for a Java job.  As you can tell this isn't a very fun interview, and I definitely don't think I'll get the job.  I hadn't written any C++ in many years and the job was for Java, of which I was an expert at the time.  In walks the next interviewer and he asks me, &quot;How would you find a substring in a string.&quot;</p>
<p>Great!  I've been studying the hell out of this problem in my free time.  I'll nail it!  I jump up and walk up to the whiteboard and explain to the guy how to make a suffix tree, how it improves search performance, how a modified heap sort makes it faster, how a suffix tree works, why it's better than a ternary search tree, and how to do it in C.  I figure, if I can show how to write one in C then that'll demonstrate I'm not just a Java dude with no hard core metal background.</p>
<p>The guy is stunned.  Like I opened a bag of fresh durian in the interview room.  He looks at the board, and stammers, &quot;Uh uh I was kind of looking for something about the Boyer-Moore search algorithm? Do you know that?&quot;  I screw up my face a little and say, &quot;Yeah but, like 10 years ago.&quot;  He shakes his head, grabs his stuff, and gets up saying, &quot;Alright, well I'll let everyone know what I think.&quot;</p>
<p>A few minutes later in walks the next interviewer.  He looks up at the white board, chuckles and scoffs at me, then asks me another C++ template meta programming question that I couldn't answer.  I did not get the job.</p>
<div class="section" id="exercise-challenge">
<h1>Exercise Challenge</h1>
<p>In this exercise you're going to take my little Python session and create your own suffix array search class.  This class will take a string, carve it into a list of suffixes, and then allow the following operations on it:</p>
<dl class="docutils">
<dt>find_shortest</dt>
<dd>Find the shortest substring that has this beginning.  In the example above, if I search for &quot;abra&quot; then it should return &quot;abra&quot;, not &quot;abracadabra&quot;.</dd>
<dt>find_longest</dt>
<dd>Find the longest substring that has this beginning.  If I search for &quot;abra&quot; you return &quot;abracadabra&quot;.</dd>
<dt>find_all</dt>
<dd>Find all substrings that start with this beginning.  This means &quot;abra&quot; returns both &quot;abra&quot; and &quot;abracadabra&quot;.</dd>
</dl>
<p>You'll want to have a good automated test for this, plus have some performance measurements.  We'll be using those in later exercises.  Once you are done you'll want to do the Study Drills to complete this exercise.</p>
</div>
<div class="section" id="study-drills">
<h1>Study Drills</h1>
<ol class="arabic simple">
<li>Once you have your tests working, rewrite this to use your <tt class="docutils literal">BSTree</tt> to do the suffix sorting and searching.  You can also use the <tt class="docutils literal">value</tt> of each <tt class="docutils literal">BSTreeNode</tt> to keep track of where this substring exists in the original string.  You can then keep the original string around.</li>
<li>How does the <tt class="docutils literal">BStree</tt> change your code for the different searching operations? Does it make it simpler or harder?</li>
</ol>
</div>
<div class="section" id="further-study">
<h1>Further Study</h1>
<p>Definitely research suffix arrays and their applications.  They are incredibly useful but not too well known by most programmers.</p>
</div>
                <!-- RST ENDS -->
            </div>
        </div>

    </div>

    <div class="row center-xs" id="buy">
        <div class="text-center col-xs-10 col-sm-5 col-md-4">
            <h2 class="section-title__small">Pre-order Learn More Python The Hard Way</h2>
            <p>
            When you pre-order Learn <b>More</b> Python The Hard Way, you'll receive the Python 3 Edition as it's being created.
            All files are DRM free and you can download them to your computer for offline viewing. <b>Digital Download Only!  You do not get a physical book.</b>
            </p>

            <p class="price-block">
            <span class="currency"><span class="prefix">$</span>29.<span class="suffix">99</span></span>
            </p>

            <a href="https://shop.learncodethehardway.org/access/buy/10/" class="btn btn-primary btn-full">Pre-Order From Zed</a>

            <p class="text-left btn-subtext">
            <small>Or, you can <a href="index.html">read Learn More Python the Hard Way for free</a> right here, video lectures not included.</small>
            </p>

        </div>
        <div class="text-center col-xs-10 col-sm-5 col-md-4 col-sm-offset-1">

            <h2 class="section-title__small">Other Buying Options</h2>
            <p>Other buying options coming soon.</p>
            <!--
 <a href="http://bit.ly/amznlpthw" class="btn btn-secondary btn-full">Buy Kindle or Paper on Amazon</a>
 <a href="http://bit.ly/informitlpthw" class="btn btn-secondary btn-full">Buy a hard copy from the Publisher</a>
 <a href="http://bit.ly/bnlpthw" class="btn btn-secondary btn-full">Buy a hard copy from Barnes &amp; Noble</a>
 -->
        </div>
    </div>


    <div class="row center-xs">
        <div class="col-xs-11 col-sm-10 col-md-9 col-lg-8" id="video_holder">
            <div data-paydiv_product="10" id='paydiv'>
                No content available for this exercise.  You can view all available downloads at <a href="https://shop.learncodethehardway.org/customers/">your customer account page</a>.
            </div>
        </div>
    </div>
    </main>

</div>

<div class="row dark bottom-nav">
    <div class="col-xs text-left">
        <a href="#" class="prev" id='prev_link'><i class="icon-arrow-67"></i> <i class="icon icon-arrow-left"></i> Previous <span class="hide-xs show-sm-inline">Lesson</span></a>
    </div>
    <div class="col-xs text-right"><a href="#" class="next" id='next_link'>Next <span class="hide-xs show-sm-inline">Lesson</span> <i class="icon icon-arrow-right"></i></a>
    </div>
</div>
    </div>

    <footer class="footer">
<div class="row center-xs">

    <div class="col-xs-11 col-sm-6 col-md-5 col-lg-5">
        <ul class="nav nav-inline">
            <li><h4><a href="https://learncodethehardway.org/">Home</a></h4></li>
            <li><h4><a href="https://learncodethehardway.org/about/">About</a></h4></li>
            <li><h4><a href="https://learncodethehardway.org/contact/">Contact</a></h4></li>
        </ul>
        <div class="copyright text-left">
            <small class="text-muted">&copy; 2016 Zed A. Shaw. All Rights Reserved.</small>
        </div>
    </div>
    <div class="col-xs-11 col-sm-4 col-md-4 col-lg-3">
        <div class="social-media">
            <div class="classy-container">
                <a href="https://twitter.com/lzsthw" class="socicon-twitter"></a>
            </div>
        </div>
    </div>
</div>

    </footer>
    <script src="../js/scripts.min.js"></script>

    <script src="javascripts/jquery.js"></script>
    <script src="index.js"></script>
    <script src="../../shop.learncodethehardway.org/static/jzed.js"></script>
    <script src="../../shop.learncodethehardway.org/static/js/videojs/video.js"></script>
    <link rel="stylesheet" href="../../shop.learncodethehardway.org/static/js/videojs/video-js.css">
    <script src="../../shop.learncodethehardway.org/static/api/v1/paydiv.js"></script>
    <script src="javascripts/app.js"></script>
    <script src="javascripts/littools.js"></script>
    <!-- Start of helpthw Zendesk Widget script -->
    <script>/*<![CDATA[*/window.zEmbed||function(e,t){var n,o,d,i,s,a=[],r=document.createElement("iframe");window.zEmbed=function(){a.push(arguments)},window.zE=window.zE||window.zEmbed,r.src="javascript:false",r.title="",r.role="presentation",(r.frameElement||r).style.cssText="display: none",d=document.getElementsByTagName("script"),d=d[d.length-1],d.parentNode.insertBefore(r,d),i=r.contentWindow,s=i.document;try{o=s}catch(e){n=document.domain,r.src='javascript:var d=document.open();d.domain="'+n+'";void(0);',o=s}o.open()._l=function(){var o=this.createElement("script");n&&(this.domain=n),o.id="js-iframe-async",o.src=e,this.t=+new Date,this.zendeskHost=t,this.zEQueue=a,this.body.appendChild(o)},o.write('<body onload="document._l();">'),o.close()}("../../assets.zendesk.com/embeddable_framework/main.js","helpthw.zendesk.com");
/*]]>*/</script>
    <!-- End of helpthw Zendesk Widget script -->

    <script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
 (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
 m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
 })(window,document,'script','../../www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-24168052-5', 'auto');
ga('send', 'pageview');

    </script>

    </body>
    
<!-- Mirrored from learncodethehardway.org/more-python-book/ex22.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 08 Jul 2017 15:17:43 GMT -->
</html>
